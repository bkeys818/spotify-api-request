name: Run test

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

  workflow_dispatch:


jobs:

  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Install modules
        run: yarn install

      - name: Create .env file
        shell: bash
        env:
          CLIENT_ID: ${{ secrets.CLIENT_ID }}
          CLIENT_SECRET: ${{ secrets.CLIENT_SECRET }}
        run: |
          cd  ${{ github.workspace }}
          touch .env
          echo "$CLIENT_ID"
          echo "$CLIENT_SECRET"
          echo "CLIENT_ID=$CLIENT_ID
          CLIENT_SECRET=$CLIENT_SECRET
          " > .env
          echo "$(cat .env)"

      - name: Run tests
        run: ./node_modules/.bin/jest tests/action.test.ts
